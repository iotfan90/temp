{% extends "base.html" %}
{% block content %}
    <div class="row">
        <div class="col-lg-12">
            {% csrf_token %}
            <div class="row">
                <div class="col-xs-12">
                    <h1>Purchase Order Report</h1>
                </div>
            </div>
            <div class="row" ng-controller="PurchaseOrderController">
                <div class="col-xs-12">
                    <div class="row small-bottom">
                        <div class="col-xs-9 col-md-2">
                            <button type="button" class="right btn marsala text-white"
                                ng-disabled="refreshReportProcessing" ng-click="refreshReport()">
                                <i class="fa fa-refresh"></i>&nbsp;Refresh report
                            </button>
                            <div class="alert alert-info text-center" ng-if="refreshReportProcessing">
                                <i class="fa fa-spin fa-gear"></i>&nbsp;Refreshing report
                            </div>
                            <div class="alert emerald text-center text-white" ng-if="refreshReportFinished && refreshReportSuccess">
                                <i class="fa fa-check-circle"></i>&nbsp;[[refreshReportMessage]]
                            </div>
                            <div class="alert alert-error text-center text-white" ng-if="refreshReportFinished && !refreshReportSuccess">
                                <i class="fa fa-bug"></i>&nbsp;[[refreshReportMessage]]
                            </div>
                        </div>
                        <div class="col-xs-3 col-md-1">
                            <form action="{% url 'sales:po-report-csv-export' %}" method="post">
                                {% csrf_token %}
                                <div class="input-hidden">
                                    <input name="selectedVendor" ng-model="selectedVendor">
                                    <input name="searchSku" ng-model="searchSku">
                                    <input name="leadTime" ng-model="leadTime">
                                    <input name="checked" ng-model="checked">
                                    <input name="fb_DecayDiscount" ng-model="fb_DecayDiscount">
                                    <input name="numOfDays" ng-model="numOfDays">
                                    <input name="serviceLevel" ng-model="serviceLevel">
                                    <input name="daysBetweenOrder" ng-model="daysBetweenOrder">
                                </div>
                                <button class="right btn marsala text-white" type="submit"><i
                                        class="fa fa-download"></i>&nbsp;CSV
                                </button>
                            </form>
                        </div>
                        <div class="col-xs-9 col-md-3">
                            <span class="label serenity">Last updated at: {{ last_updated_dt }}</span>
                        </div>
                        <div class="col-xs-9 col-md-3">
                            <button type="button" class="btn serenity" data-toggle="modal" data-target="#optionModal">
                                Search options
                            </button>
                        </div>
                    </div>
                </div>
                <div class="container">
                    <div class="modal fade" id="optionModal" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <form ng-submit="submitData()">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        <h4 class="modal-title">Option fields</h4>
                                    </div>
                                    <div class="modal-body">
                                        <label for="selVendor" class="col-sm-10 form-control-label text-right">Vendor
                                            List</label>
                                        <select id="selVendor" class="form-control" ng-options="x for x in vendors"
                                                ng-model="selectedVendor">
                                            <option value="">-- Choose a vendor --</option>
                                        </select>
                                        <label for="searchSku"
                                               class="col-sm-10 form-control-label text-right">SKU</label>
                                        <input type="text" class="form-control" name="searchSku"
                                               id="searchSku" ng-model="searchSku">
                                        <label for="leadTime" class="col-sm-10 form-control-label text-right">Lead
                                            Time</label>
                                        <input type="text" class="form-control" name="leadTime"
                                               id="leadTime" ng-model="leadTime">
                                        <label for="daysBetweenOrder"
                                               class="col-sm-10 form-control-label text-right">Days&nbsp;Between&nbsp;Order</label>
                                        <input type="text" class="form-control" name="daysBetweenOrder"
                                               id="daysBetweenOrder" ng-model="daysBetweenOrder">
                                        <label for="serviceLevel"
                                               class="col-sm-10 form-control-label text-right">Service&nbsp;Level</label>
                                        <input type="text" class="form-control" name="serviceLevel"
                                               id="serviceLevel" ng-model="serviceLevel">
                                        <label for="numOfDays" class="col-sm-10 form-control-label text-right">Num Of
                                            Days In
                                            Stock</label>
                                        <input type="text" class="form-control" name="numOfDays"
                                               id="numOfDays" ng-model="numOfDays">
                                        <div class="checkbox">
                                            <label>
                                                <input type="checkbox" ng-model="checked"/>&nbsp;&nbsp;FB SKU
                                            </label>
                                        </div>
                                        <label for="fb_DecayDiscount" class="col-sm-10 form-control-label text-right">Facebook
                                            Decay Discount</label>
                                        <input ng-disabled="!checked" type="text" class="form-control"
                                               name="fb_DecayDiscount"
                                               id="fb_DecayDiscount" ng-model="fb_DecayDiscount">
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Close
                                        </button>
                                        <button type="submit" class="btn btn-primary">Save changes</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-12">
                        <table class="table table-striped table-bordered">
                            <thead class="thead-default">
                            <tr>
                                <th class="clickable" ng-click="addSort('product_id')">
                                    Product&nbsp;Id
                                    <i class='fa'
                                       ng-class="{ 'fa-angle-down': currentSort=='-product_id', 'fa-angle-up': currentSort == 'product_id' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('sku')">
                                    SKU&nbsp;
                                    <i class='fa'
                                       ng-class="{ 'fa-angle-down': currentSort=='-sku', 'fa-angle-up': currentSort == 'sku' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('vendor_sku')">
                                    Vendor&nbsp;SKU
                                    <i class='fa'
                                       ng-class="{ 'fa-angle-down': currentSort=='-vendor_sku', 'fa-angle-up': currentSort == 'vendor_sku' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('vendor_name')">
                                    Vendor&nbsp;Name
                                    <i class='fa'
                                       ng-class="{ 'fa-angle-down': currentSort=='-vendor_name', 'fa-angle-up': currentSort == 'vendor_sku' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('name')">
                                    Name&nbsp;<i class='fa'
                                                 ng-class="{ 'fa-angle-down': currentSort=='-name', 'fa-angle-up': currentSort == 'name' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('qty')">
                                    Inventory&nbsp;<i class='fa'
                                                      ng-class="{ 'fa-angle-down': currentSort=='-qty', 'fa-angle-up': currentSort == 'qty' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('is_in_stock')">
                                    In&nbsp;Stock&nbsp;<i class='fa'
                                                          ng-class="{ 'fa-angle-down': currentSort=='-is_in_stock', 'fa-angle-up': currentSort == 'is_in_stock' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('back_orders')">
                                    Back&nbsp;Orders&nbsp;<i class='fa'
                                                             ng-class="{ 'fa-angle-down': currentSort=='-back_orders', 'fa-angle-up': currentSort == 'back_orders' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('base_cost')">
                                    COGS&nbsp;<i class='fa'
                                                 ng-class="{ 'fa-angle-down': currentSort=='-base_cost', 'fa-angle-up': currentSort == 'base_cost' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('price')">
                                    Price&nbsp;<i class='fa'
                                                  ng-class="{ 'fa-angle-down': currentSort=='-price', 'fa-angle-up': currentSort == 'price' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('margin')">
                                    Margin&nbsp;<i class='fa'
                                                   ng-class="{ 'fa-angle-down': currentSort=='-margin', 'fa-angle-up': currentSort == 'margin' }"></i>
                                </th>
                                <th>Image</th>
                                <th class="clickable" ng-click="addSort('attribute_set')">
                                    Type&nbsp;<i class='fa'
                                                 ng-class="{ 'fa-angle-down': currentSort=='-attribute_set', 'fa-angle-up': currentSort == 'attribute_set' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('category')">
                                    Model&nbsp;<i class='fa'
                                                  ng-class="{ 'fa-angle-down': currentSort=='-category', 'fa-angle-up': currentSort == 'category' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('day_1')">
                                    Previous&nbsp;Day&nbsp;<i class='fa'
                                                              ng-class="{ 'fa-angle-down': currentSort=='-day_1', 'fa-angle-up': currentSort == 'day_1' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('day_3')">
                                    Last&nbsp;3&nbsp;Days&nbsp;<i class='fa'
                                                                  ng-class="{ 'fa-angle-down': currentSort=='-day_3', 'fa-angle-up': currentSort == 'day_3' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('day_7')">
                                    Last&nbsp;7&nbsp;Days&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-day_7', 'fa-angle-up': currentSort == 'day_7' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('day_14')">
                                    Last&nbsp;14&nbsp;Days&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-day_14', 'fa-angle-up': currentSort == 'day_14' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('day_30')">
                                    Last&nbsp;30&nbsp;Days&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-day_30', 'fa-angle-up': currentSort == 'day_30' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('day_90')">
                                    Last&nbsp;90&nbsp;Days&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-day_90', 'fa-angle-up': currentSort == 'day_90' }"></i>
                                </th>
{#                                <th class="clickable" ng-click="addSort('day_7_avg')">#}
{#                                    7&nbsp;Day&nbsp;Avg&nbsp;<i#}
{#                                        class='fa'#}
{#                                        ng-class="{ 'fa-angle-down': currentSort=='-day_7_avg', 'fa-angle-up': currentSort == 'day_7_avg' }"></i>#}
{#                                </th>#}
{#                                <th class="clickable" ng-click="addSort('day_3_avg')">#}
{#                                    3&nbsp;Day&nbsp;Avg&nbsp;<i#}
{#                                        class='fa'#}
{#                                        ng-class="{ 'fa-angle-down': currentSort=='-day_3_avg', 'fa-angle-up': currentSort == 'day_3_avg' }"></i>#}
{#                                </th>#}
                                <th class="clickable" ng-click="addSort('new_day_3_avg')">
                                    New&nbsp;3&nbsp;Day&nbsp;Avg&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-po_day3_avg', 'fa-angle-up': currentSort == 'po_day3_avg' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('new_day_7_avg')">
                                    New&nbsp;7&nbsp;Day&nbsp;Avg&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-po_day7_avg', 'fa-angle-up': currentSort == 'po_day7_avg' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('new_day_14_avg')">
                                    New&nbsp;14&nbsp;Day&nbsp;Avg&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-po_day14_avg', 'fa-angle-up': currentSort == 'po_day14_avg' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('new_day_30_avg')">
                                    New&nbsp;30&nbsp;Day&nbsp;Avg&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-po_day30_avg', 'fa-angle-up': currentSort == 'po_day30_avg' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('new_day_90_avg')">
                                    New&nbsp;90&nbsp;Day&nbsp;Avg&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-po_day90_avg', 'fa-angle-up': currentSort == 'po_day90_avg' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('forecast_daily_demand)')">
                                    Forecast&nbsp;Daily&nbsp;Demand&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-forecast_daily_demand', 'fa-angle-up': currentSort == 'forecast_daily_demand' }"></i>
                                </th>
                                 <th class="clickable" ng-click="addSort('stdev_of_demand)')">
                                    Stdev&nbsp;Of&nbsp;Demand&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-stdev_of_demand', 'fa-angle-up': currentSort == 'stdev_of_demand' }"></i>
                                </th>

                                <th class="clickable" ng-click="addSort('stdev_of_demand_over_vp')">
                                    Stdev&nbsp;of&nbsp;Demand&nbsp;for&nbsp;Vulnerable&nbsp;Period<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-stdev_of_demand_over_vp', 'fa-angle-up': currentSort == 'stdev_of_demand_over_vp' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('standardized_metric_of_service_level)')">
                                    Standardized&nbsp;Metric&nbsp;Of&nbsp;Service&nbsp;Level&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-standardized_metric_of_service_level', 'fa-angle-up': currentSort == 'standardized_metric_of_service_level' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('demand_for_vp)')">
                                    Demand&nbsp;for&nbsp;Vulnerable&nbsp;Period&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-demand_for_vp', 'fa-angle-up': currentSort == 'demand_for_vp' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('safety_stock)')">
                                    Safety&nbsp;Stock&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-safety_stock', 'fa-angle-up': currentSort == 'safety_stock' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('qty_needed_for_vp)')">
                                    Qty&nbsp;needed&nbsp;for&nbsp;VP&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-qty_needed_for_vp', 'fa-angle-up': currentSort == 'qty_needed_for_vp' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('hr_qty)')">
                                    Vendor&nbsp;qty&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-hr_qty', 'fa-angle-up': currentSort == 'hr_qty' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('is_order)')">
                                    Order?&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-is_order', 'fa-angle-up': currentSort == 'is_order' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('order_qty)')">
                                    Order&nbsp;Quantity&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-order_qty', 'fa-angle-up': currentSort == 'order_qty' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('order_celling)')">
                                    Order&nbsp;Celling&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-order_celling', 'fa-angle-up': currentSort == 'order_celling' }"></i>
                                </th>


                                <th class="clickable" ng-click="addSort('day_7_left')">
                                    Days&nbsp;of&nbsp;Inventory&nbsp;Left&nbsp;(7)&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-day_7_left', 'fa-angle-up': currentSort == 'day_7_left' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('day_3_left')">
                                    Days&nbsp;of&nbsp;Inventory&nbsp;Left&nbsp;(3)&nbsp;<i
                                        class='fa'
                                        ng-class="{ 'fa-angle-down': currentSort=='-day_3_left', 'fa-angle-up': currentSort == 'day_3_left' }"></i>
                                </th>
                                <!--<th class="clickable" ng-click="addSort('run_rate_7')">-->
                                    <!--Run&nbsp;Rate&nbsp;(7)&nbsp;<i class='fa'-->
                                                                   <!--ng-class="{ 'fa-angle-down': currentSort=='-run_rate_7', 'fa-angle-up': currentSort == 'run_rate_7' }"></i>-->
                                <!--</th>-->
                                <!--<th class="clickable" ng-click="addSort('run_rate_14')">-->
                                    <!--Run&nbsp;Rate&nbsp;(14)<i class='fa'-->
                                                              <!--ng-class="{ 'fa-angle-down': currentSort=='-run_rate_14', 'fa-angle-up': currentSort == 'run_rate_14 ' }"></i>-->
                                <!--</th>-->
                                <!--<th class="clickable" ng-click="addSort('run_rate_30')">-->
                                    <!--Run&nbsp;Rate&nbsp;(30)&nbsp;<i class='fa'-->
                                                                    <!--ng-class="{ 'fa-angle-down': currentSort=='-run_rate_30', 'fa-angle-up': currentSort == 'run_rate_30' }"></i>-->
                                <!--</th>-->
                                <!--<th class="clickable" ng-click="addSort('run_rate_90')">-->
                                    <!--Run&nbsp;Rate&nbsp;(90)&nbsp;<i class='fa'-->
                                                                    <!--ng-class="{ 'fa-angle-down': currentSort=='-run_rate_90', 'fa-angle-up': currentSort == 'run_rate_90' }"></i>-->
                                <!--</th>-->
                                <!--<th class="clickable" ng-click="addSort('avg_left')">-->
                                    <!--Days&nbsp;of&nbsp;Inventory&nbsp;Left&nbsp;(3,&nbsp;7)&nbsp;<i class='fa'-->
                                                                                                   <!--ng-class="{ 'fa-angle-down': currentSort=='-avg_left', 'fa-angle-up': currentSort == 'avg_left' }"></i>-->
                                <!--</th>-->
                                <th class="clickable" ng-click="addSort('avg_run_rate')">
                                    Avg&nbsp;Days&nbsp;In&nbsp;Stock&nbsp;Remaining(3,&nbsp;7,&nbsp;14,&nbsp;30,&nbsp;90)&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-avg_run_rate', 'fa-angle-up': currentSort == 'run_rate_90' }"></i>
                                </th>
                                <th ng-show="checked===true">FB&nbsp;Decay&nbsp;Discount&nbsp;
                                </th>
                                <th ng-show="checked===true" class="clickable" ng-click="addSort('pre_fb_run_rate')">
                                    Predict&nbsp;FB&nbsp;Run&nbsp;Rate&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-pre_fb_run_rate', 'fa-angle-up': currentSort == 'pre_fb_run_rate' }"></i>
                                </th>
                                <th>Lead&nbsp;Time&nbsp;(in&nbsp;days)
                                </th>
                                <th>Number&nbsp;Of&nbsp;Reorder&nbsp;Days&nbsp;
                                </th>
                                <th class="clickable" ng-click="addSort('reorder_units')">
                                    Reorder&nbsp;Units&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-reorder_units', 'fa-angle-up': currentSort == 'reorder_units' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('extended_grand_total')">
                                    Extended&nbsp;Grand&nbsp;Total&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-extended_grand_total', 'fa-angle-up': currentSort == 'extended_grand_total' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('pending_po_id')">
                                    Pending&nbsp;PO&nbsp;#&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-pending_po_id', 'fa-angle-up': currentSort == 'pending_po_id' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('pending_po_qty')">
                                    Pending&nbsp;PO&nbsp;Qty&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-pending_po_qty', 'fa-angle-up': currentSort == 'pending_po_qty' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('pending_po_date')">
                                    Pending&nbsp;PO&nbsp;Date&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-pending_po_date', 'fa-angle-up': currentSort == 'pending_po_date' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('last_received_date')">
                                    Last&nbsp;Received&nbsp;Date&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-last_received_date', 'fa-angle-up': currentSort == 'last_received_date' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('last_received_qty')">
                                    Last&nbsp;Received&nbsp;Quantity&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-last_received_qty', 'fa-angle-up': currentSort == 'last_received_qty' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('w1_model')">
                                    W1&nbsp;Model&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-w1_model', 'fa-angle-up': currentSort == 'w1_model' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('w2_model')">
                                    W2&nbsp;Model&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-w2_model', 'fa-angle-up': currentSort == 'w2_model' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('w3_model')">
                                    W3&nbsp;Model&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-w3_model', 'fa-angle-up': currentSort == 'w3_model' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('w4_model')">
                                    W4&nbsp;Model&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-w4_model', 'fa-angle-up': currentSort == 'w4_model' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('w1_square_errors')">
                                    W1&nbsp;Square&nbsp;Error&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-w1_square_errors', 'fa-angle-up': currentSort == 'w1_square_errors' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('w2_square_errors')">
                                    W2&nbsp;Square&nbsp;Error&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-w2_square_errors', 'fa-angle-up': currentSort == 'w2_square_errors' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('w3_square_errors')">
                                    W3&nbsp;Square&nbsp;Error&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-w3_square_errors', 'fa-angle-up': currentSort == 'w3_square_errors' }"></i>
                                </th>
                                <th class="clickable" ng-click="addSort('w4_square_errors')">
                                    W4&nbsp;Square&nbsp;Error&nbsp;<i class='fa' ng-class="{ 'fa-angle-down': currentSort=='-w4_square_errors', 'fa-angle-up': currentSort == 'w4_square_errors' }"></i>
                                </th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="product in currentPage" ng-if="currentPage.length" class="small-btn">
                                <td>[[product.product_id]]</td>
                                <td>[[product.sku]]</td>
                                <td>
                                    <li ng-repeat="sku in product.vendor_sku track by $index">[[sku]]</li>
                                </td>
                                <td>
                                    <li ng-repeat="name in product.vendor_name track by $index">[[name]]</li>
                                </td>
                                <td>[[product.name]]</td>
                                <td>[[product.qty]]</td>
                                <td>[[product.is_in_stock]]</td>
                                <td>[[product.back_orders]]</td>
                                <td>[[product.base_cost]]</td>
                                <td>[[product.price]]</td>
                                <td>[[product.margin]]</td>
                                <td><img ng-src="[[product.image]]" width="130" height="130"/></td>
                                <td>[[product.attribute_set]]</td>
                                <td>[[product.category]]</td>
                                <td>[[product.day_1]]</td>
                                <td>[[product.day_3]]</td>
                                <td>[[product.day_7]]</td>
                                <td>[[product.day_14]]</td>
                                <td>[[product.day_30]]</td>
                                <td>[[product.day_90]]</td>
                                <td>[[product.po_day3_avg]]</td>
                                <td>[[product.po_day7_avg]]</td>
                                <td>[[product.po_day14_avg]]</td>
                                <td>[[product.po_day30_avg]]</td>
                                <td>[[product.po_day90_avg]]</td>
                                <td>[[product.forecast_daily_demand]]</td>
                                <td>[[product.stdev_of_demand]]</td>
                                <td>[[product.stdev_of_demand_over_vp]]</td>
                                <td>[[product.standardized_metric_of_service_level]]</td>
                                <td>[[product.demand_for_vp]]</td>
                                <td>[[product.safety_stock]]</td>
                                <td>[[product.qty_needed_for_vp]]</td>
                                <td>[[product.hr_qty]]</td>
                                <td>[[product.is_order]]</td>
                                <td>[[product.order_qty]]</td>
                                <td>[[product.order_celling]]</td>
                                <td>[[product.day_7_left]]</td>
                                <td>[[product.day_3_left]]</td>
                                <!--<td>[[product.run_rate_7_po]]</td>-->
                                <!--<td>[[product.run_rate_14_po]]</td>-->
                                <!--<td>[[product.run_rate_30_po]]</td>-->
                                <!--<td>[[product.run_rate_90_po]]</td>-->
                                <!--<td>[[product.avg_left]]</td>-->
                                <td>[[product.avg_run_rate_po]]</td>
                                <td ng-show="checked===true">[[product.fb_decay_discount]]</td>
                                <td ng-show="checked===true">[[product.pre_fb_run_rate]]</td>
                                <td>[[product.lead_time]]</td>
                                <td>[[product.num_of_days]]</td>
                                <td>[[product.reorder_units]]</td>
                                <td>[[product.extended_grand_total]]</td>
                                <td>
                                    <li ng-repeat="pending_po_id in product.pending_po_id track by $index">
                                        [[pending_po_id]]
                                    </li>
                                </td>
                                <td>
                                    <li ng-repeat="pending_po_qty in product.pending_po_qty track by $index">
                                        [[pending_po_qty]]
                                    </li>
                                </td>
                                <td>
                                    <li ng-repeat="pending_po_date in product.pending_po_date track by $index">
                                        [[pending_po_date]]
                                    </li>
                                </td>
                                <td>[[product.last_received_date]]</td>
                                <td>[[product.last_received_qty]]</td>
                                <td>[[product.w1_model]]</td>
                                <td>[[product.w2_model]]</td>
                                <td>[[product.w3_model]]</td>
                                <td>[[product.w4_model]]</td>
                                <td>[[product.w1_square_errors]]</td>
                                <td>[[product.w2_square_errors]]</td>
                                <td>[[product.w3_square_errors]]</td>
                                <td>[[product.w4_square_errors]]</td>
                            </tr>
                            <tr ng-if="pageProducts.length == 0 && !loading">
                                <td colspan="9">
                                    No Products Found
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <nav>
                    <ul class="pagination pagination-lg">
                        <li ng-class="pageData.current==1 ? 'disabled' : 'enabled'" class="page-item">
                            <a ng-class="pageData.current==1 ? 'disabled' : 'enabled'" class="page-link"
                               ng-click=firstPage() aria-label="First">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <li ng-repeat="p in ::pageData.pages" class="page-item"
                            ng-class="p==pageData.current ? 'active' : 'not-active'">
                            <a class="page-link" ng-click=selectPage(p)>[[ p ]]</a>
                        </li>
                        <li ng-class="pageData.current==pageData.last_page ? 'disabled' : 'enabled'" class="page-item">
                            <a ng-class="pageData.current==pageData.last_page ? 'disabled' : 'enabled'"
                               class="page-link"
                               ng-click=lastPage() aria-label="Next">
                                <span aria-hidden="true">Â»</span></a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
    </div>

    <script>
        window.poReportData = {};
        window.poReportData.pageProducts = {{ page_products|safe }};
        window.poReportData.vendors = {{ vendors|safe }};
        window.currentSort = '{{ st_sort }}';
        window.refreshReportEndpoint = '{% url 'sales:sales-report' %}';
    </script>
{% endblock %}
